# ==============================================================================
# Django Core
# ==============================================================================

# ENV: Application environment identifier
# Values: backend-dev, backend-prod
ENV=backend-prod

# DEBUG: Enable Django debug mode (never enable in production)
# Values: on, off
DEBUG=off

# DEBUG_TOOLBAR: Enable Django Debug Toolbar (requires DEBUG=on)
# Values: on, off
DEBUG_TOOLBAR=off

# SECRET_KEY: Django secret key for cryptographic signing
# SECURITY: Must be unique and unpredictable in production
SECRET_KEY=

# LOG_LEVEL: Root logging level
# Values: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Media files storage path (inside container)
MEDIA_ROOT=/root/src/media

# ==============================================================================
# Database (PostgreSQL)
# ==============================================================================

POSTGRES_DB=project
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=

# DATABASE_POOL_URL: Transaction-based connection pool URL (e.g., PgBouncer)
# WARNING: Using this as DATABASE_URL will break production
DATABASE_POOL_URL=

# DATABASE_URL: Direct PostgreSQL connection URL
# Used as fallback when DATABASE_POOL_URL is not set
DATABASE_URL=postgres://postgres:@db:5432/project

# ==============================================================================
# Redis
# ==============================================================================

REDIS_HOST=redis
REDIS_PORT=6379

# ==============================================================================
# Celery (Task Queue)
# ==============================================================================

# CELERY_BROKER_URL: Redis URL for Celery message broker
CELERY_BROKER_URL=redis://redis:6379/0

# CELERY_TASK_ALWAYS_EAGER: Execute tasks synchronously (1=sync, 0=async)
# Use 1 for development, 0 for production
CELERY_TASK_ALWAYS_EAGER=0

# Worker concurrency (number of concurrent worker processes per queue)
CELERY_MASTER_CONCURRENCY=2
CELERY_WORKER_CONCURRENCY=6
CELERY_METAGRAPH_CONCURRENCY=2

# Celery Flower monitoring dashboard credentials
CELERY_FLOWER_USER=flower
CELERY_FLOWER_PASSWORD=

# ==============================================================================
# Web Server & CORS
# ==============================================================================

NGINX_HOST=

# CORS_ENABLED: Enable Cross-Origin Resource Sharing
CORS_ENABLED=on

# CORS_ALLOWED_ORIGINS: Comma-separated list of allowed origins
CORS_ALLOWED_ORIGINS=

# CORS_ALLOWED_ORIGIN_REGEXES: Comma-separated regex patterns for allowed origins
CORS_ALLOWED_ORIGIN_REGEXES=

# CORS_ALLOW_ALL_ORIGINS: Allow all origins (use only in development)
CORS_ALLOW_ALL_ORIGINS=0

# ==============================================================================
# Bittensor Network
# ==============================================================================

# BITTENSOR_ARCHIVE_NETWORK: Archive node for querying old blocks
# Used automatically when block is >300 blocks behind chain head
# Values: archive, finney, local, testnet
BITTENSOR_ARCHIVE_NETWORK=archive

# ==============================================================================
# Sentinel Mode
# ==============================================================================

# SENTINEL_MODE: Block processing mode
# Values:
#   live          - Real-time block processing, follows chain head (default)
#   backfill      - Legacy sequential backfill with rate limiting
#   fast_backfill - Lite APY-only synchronous backfill (single connection, no Celery)
#   apy_backfill  - Lite APY-only backfill tuned for throughput (batch_size=50, delay=0.5s)
SENTINEL_MODE=live

# BLOCK_START / BLOCK_END: Block range boundaries
# Required when SENTINEL_MODE=backfill, fast_backfill, or apy_backfill
BLOCK_START=
BLOCK_END=

# NETUID: Specific subnet UID to backfill (optional, default: all configured netuids)
# Used in fast_backfill and apy_backfill modes
NETUID=

# BACKFILL_RATE_LIMIT: Seconds between blocks in backfill mode
BACKFILL_RATE_LIMIT=1.0

# BACKFILL_STEP: Block step size for fast_backfill and apy_backfill modes (default: 1)
BACKFILL_STEP=1

# BACKFILL_BATCH_SIZE: Blocks per Celery task
# Default: 10 (fast_backfill), 50 (apy_backfill)
BACKFILL_BATCH_SIZE=10

# BACKFILL_BATCH_DELAY: Seconds between spawning batch tasks
# Default: 1.0 (fast_backfill), 0.5 (apy_backfill)
BACKFILL_BATCH_DELAY=1.0

# ==============================================================================
# Sentinel Plugins
# ==============================================================================

# SENTINEL_PLUGINS: Comma-separated list of enabled block task plugins
# Available: extrinsics, metagraph
# Empty = all plugins enabled
# Examples:
#   SENTINEL_PLUGINS=extrinsics,metagraph  # both plugins
#   SENTINEL_PLUGINS=extrinsics            # only extrinsics sync
#   SENTINEL_PLUGINS=metagraph             # only metagraph dump
SENTINEL_PLUGINS=

# ==============================================================================
# Metagraph Configuration
# ==============================================================================

# METAGRAPH_NETUIDS: Comma-separated list of subnet UIDs to sync
# Empty = all subnets (1-128)
# Example: METAGRAPH_NETUIDS=1,8,19
METAGRAPH_NETUIDS=

# METAGRAPH_LITE: Enable lite mode (excludes weights and bonds data)
# Values: 0 (full mode), 1 (lite mode)
METAGRAPH_LITE=0

# ==============================================================================
# Sentinel Storage (S3)
# ==============================================================================

# S3 backend configuration (leave empty to use local filesystem only)
SENTINEL_STORAGE_S3_BUCKET=
SENTINEL_STORAGE_S3_BASE_PATH=
SENTINEL_STORAGE_S3_AWS_REGION=
SENTINEL_STORAGE_S3_AWS_ACCESS_KEY_ID=
SENTINEL_STORAGE_S3_AWS_SECRET_ACCESS_KEY=

# ==============================================================================
# Discord Alerts
# ==============================================================================

# Real-time webhook notifications when matching extrinsics are detected
# Create webhooks: Discord > Server Settings > Integrations > Webhooks
DISCORD_SUDO_ALERTS_WEBHOOK_URL=
DISCORD_ADMIN_UTILS_ALERTS_WEBHOOK_URL=
DISCORD_SUBNET_REGISTRATION_WEBHOOK_URL=
DISCORD_COLDKEY_SWAP_WEBHOOK_URL=

# ==============================================================================
# Slack Alerts
# ==============================================================================

# SLACK_WEBHOOK_URL: Alertmanager Slack notifications
# Get webhook URL from: https://api.slack.com/messaging/webhooks
SLACK_WEBHOOK_URL=

# ==============================================================================
# Monitoring (Grafana)
# ==============================================================================

GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=

# ==============================================================================
# Logging (Loki)
# ==============================================================================

LOKI_URL=https://loki.reef.pl
LOKI_REFRESH_INTERVAL=5s
LOKI_USER=
LOKI_PASSWORD=
LOKI_CLIENT=
LOKI_CLIENT_SERVER_GROUP=

# ==============================================================================
# Email
# ==============================================================================

# EMAIL_BACKEND: Django email backend class
# Dev:  django.core.mail.backends.filebased.EmailBackend (writes to EMAIL_FILE_PATH)
# Prod: django.core.mail.backends.smtp.EmailBackend
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_FILE_PATH=/tmp/email
EMAIL_HOST=smtp.sendgrid.net
EMAIL_PORT=587
EMAIL_USE_TLS=1
EMAIL_HOST_USER=apikey
EMAIL_HOST_PASSWORD=
DEFAULT_FROM_EMAIL=

# ==============================================================================
# Error Tracking (Sentry)
# ==============================================================================

# SENTRY_DSN: Sentry Data Source Name (leave empty to disable)
SENTRY_DSN=
SENTRY_ENVIRONMENT=production

# ==============================================================================
# Content Security Policy (CSP)
# ==============================================================================

CSP_ENABLED=n
CSP_REPORT_ONLY=y
CSP_REPORT_URL=""
CSP_DEFAULT_SRC="'none'"
CSP_SCRIPT_SRC="'self'"
CSP_STYLE_SRC="'self'"
CSP_FONT_SRC="'self'"
CSP_IMG_SRC="'self'"
CSP_MEDIA_SRC="'self'"
CSP_OBJECT_SRC="'self'"
CSP_FRAME_SRC="'self'"
CSP_CONNECT_SRC="'self'"
CSP_CHILD_SRC="'self'"
CSP_MANIFEST_SRC="'self'"
CSP_WORKER_SRC="'self'"
CSP_BLOCK_ALL_MIXED_CONTENT=y
CSP_EXCLUDE_URL_PREFIXES=

# ==============================================================================
# Docker (cadvisor)
# ==============================================================================

# DOCKER_ROOT_DIR: Docker data root directory
# Override when Docker stores data on a non-default path (e.g., mounted volume)
# Default: /var/lib/docker
DOCKER_ROOT_DIR=/var/lib/docker

# ==============================================================================
# Backups (Backblaze B2)
# ==============================================================================

BACKUP_LOCAL_ROTATE_KEEP_LAST=
BACKUP_B2_BUCKET=
BACKUP_B2_FOLDER=
BACKUP_B2_APPLICATION_KEY_ID=
BACKUP_B2_APPLICATION_KEY=
